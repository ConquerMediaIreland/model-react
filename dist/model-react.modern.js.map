{"version":3,"file":"model-react.modern.js","sources":["../src/cmp/BasicForm.js"],"sourcesContent":["import React, { Fragment, useCallback } from 'react'\n\nimport { useSelector } from 'react-redux'\n\nimport { Gubu, Skip, Exact, Any, Required, Value } from 'gubu'\n\n\n\nconst BasicFormShape = Gubu({\n  name: String,\n  slice: String,\n  title: Skip(String),\n  intro: Skip(String),\n  btnTitle: Skip(String),\n  field: Value({\n    // name: String,\n    title: String,\n    kind: Exact('line','toggle','choice','custom'),\n    // subtype: Skip(Exact('email')),\n    subkind: Skip(String),\n    placeholder: Skip(String),\n    items: Skip([{\n      value: Required(Any()),\n      text: String,\n    }]),\n    explainer: Skip(String),\n    orient: 'vertical',\n    classes: '',\n    cmp: Any(),\n  },{}),\n  submit: Function,\n  submitCmp: Any(),\n  // orient: Default('vertical', Exact('vertical','horizontal'))\n  orient: 'vertical',\n  classes: '',\n})\n\n\n\nfunction BasicField(props) {\n  const field = props.field\n  const form = props.form\n  const store = props.store\n  \n  const { name, title, orient, kind } = field\n\n  const classes = 'vxg-basic-field vxg-basic-field-'+orient+\n        ' vxg-basic-field-'+kind+' '+\n        field.classes\n\n  const value = useSelector(state => state[form.slice][form.name][name])\n  \n  const onChange = (ev)=>{\n    store.dispatch({\n      // type: form.slice + '/setField_' + form.name,\n      // payload: { name, value: ev.target.value }\n      type: form.slice + '/setFormField',\n      payload: { form: form.name, name, value: ev.target.value }\n    })\n  }\n\n  \n  \n  return (\n    <div className={classes}>\n\n      { 'toggle' === field.kind ?\n        <input\n          type=\"checkbox\"\n          id={form.name+'-'+field.name}\n          name={field.name}\n          value={value}\n          onChange={onChange}\n        /> : <></> }\n\n      <label htmlFor={name}>{title}</label>\n\n      { 'line' === field.kind ?\n        <input\n          id={form.name+'-'+field.name}\n          name={field.name}\n          placeholder={field.placeholder}\n          value={value}\n          onChange={onChange}\n        /> : <></> }\n\n      { 'choice' === field.kind ?\n        <select\n          id={form.name+'-'+field.name}\n          name={field.name}\n          placeholder={field.placeholder}\n          value={value}\n          onChange={onChange}\n        >\n\n          { field.items.map(\n            item=>\n              <option\n                key={item.value}\n                value={item.value}\n              >\n                {item.text}\n              </option>\n          )}\n\n        </select> : <></> }\n\n      { 'custom' === field.kind ? field.cmp : <></> }\n\n    </div>\n  )\n}\n\n\nfunction getBasicForm(conf) {\n  let { store } = conf\n  \n  function BasicForm(props) {\n    console.log('BasicForm A', props)\n\n    const form = BasicFormShape(props.form)\n    \n    const meta = useSelector(state => state[form.slice].form[form.name])\n    \n    const title = form.title\n    const intro = form.intro\n    const name = form.name\n    const slice = form.slice\n    const btnTitle = form.btnTitle\n    const blank = form.blank\n    const submit = form.submit || (() => null)\n    const submitCmp = form.submitCmp\n    const orient = form.orient\n    const classes = form.classes\n\n\n    const fields = Object.entries(form.field)\n          .reduce(((a,entry)=>(a.push({name:entry[0],...entry[1]}),a)),[])\n    \n    return (\n      <form\n        name={name}\n        onSubmit={submit}\n        className={'vxg-basic-form vxg-basic-form-'+orient+' '+classes}\n      >\n        {null != title ? <h2>{title}</h2> : <></>}\n\n        {null != intro ? <p className=\"intro\">{intro}</p> : <></>}\n\n        { fields\n          .map(field =>\n               <BasicField\n                 key={field.name}\n                 field={field}\n                 form={form}\n                 store={store}\n\n               />) }\n\n        { submitCmp }\n        \n      </form>\n    )\n\n    \n  }\n\n  return {\n    BasicFormShape,\n    BasicField,\n    BasicForm,\n  }\n}\n\n\nexport {\n  getBasicForm\n}\n\n"],"names":["BasicFormShape","Gubu","name","String","slice","title","Skip","intro","btnTitle","field","Value","kind","Exact","subkind","placeholder","items","value","Required","Any","text","explainer","orient","classes","cmp","submit","Function","submitCmp","BasicField","props","form","store","useSelector","state","onChange","ev","dispatch","type","payload","target","map","item","getBasicForm","conf","BasicForm","console","log","meta","fields","Object","entries","reduce","a","entry","push"],"mappings":"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"}